<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Login / Cadastro • Magaxia</title>

<style>
/* ===== FUNDO FUTURISTA ===== */
body{
  margin:0;
  padding:0;
  height:100vh;
  font-family:Arial, sans-serif;
  color:#fff;
  background:radial-gradient(circle at top, #0a1b3d 0%, #030814 70%);
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

/* BRILHOS FLUTUANTES */
body::before{
  content:"";
  position:absolute;
  width:260px;
  height:260px;
  background:rgba(0,140,255,0.35);
  border-radius:50%;
  top:12%;
  left:10%;
  filter:blur(90px);
  animation:float 7s infinite alternate;
}

body::after{
  content:"";
  position:absolute;
  width:240px;
  height:240px;
  background:rgba(0,110,255,0.25);
  border-radius:50%;
  bottom:5%;
  right:12%;
  filter:blur(80px);
  animation:float2 8s infinite alternate;
}

@keyframes float{
  from{transform:translateY(0);}
  to{transform:translateY(40px);}
}
@keyframes float2{
  from{transform:translateY(0);}
  to{transform:translateY(-40px);}
}

/* ===== CARD FUTURISTA ===== */
.card{
  position:relative;
  background:rgba(15,20,32,0.80);
  padding:30px;
  width:100%;
  max-width:380px;
  border-radius:18px;
  backdrop-filter:blur(12px);
  box-shadow:0 0 25px rgba(0,150,255,0.40);
  border:1px solid rgba(0,150,255,0.4);
  animation:glow 4s infinite alternate;
  z-index:5;
}

@keyframes glow{
  from{ box-shadow:0 0 18px rgba(0,150,255,0.35); }
  to{ box-shadow:0 0 32px rgba(0,180,255,0.55); }
}

/* ===== TÍTULO COM BRILHO ===== */
h2{
  text-align:center;
  margin-top:0;
  margin-bottom:18px;
  font-size:26px;
  letter-spacing:1px;
  background:linear-gradient(90deg,#7ecbff,#fff,#7ecbff);
  background-size:200%;
  -webkit-background-clip:text;
  color:transparent;
  animation:shine 3s linear infinite;
}

@keyframes shine{
  from{background-position:0%;}
  to{background-position:200%;}
}

/* ===== INPUTS NEON ===== */
input{
  width:100%;
  padding:12px;
  margin:10px 0;
  border-radius:8px;
  border:1px solid rgba(0,150,255,0.45);
  background:rgba(10,15,26,0.85);
  color:#bce1ff;
  font-size:16px;
  outline:none;
  transition:0.3s;
}
input:focus{
  box-shadow:0 0 12px rgba(0,170,255,0.8);
  border-color:#00aaff;
}

/* ===== BOTÃO ===== */
button{
  width:100%;
  padding:14px;
  margin-top:8px;
  border-radius:8px;
  border:none;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  background:linear-gradient(90deg,#00aaff,#4dc4ff);
  color:#000;
  box-shadow:0 0 15px rgba(0,160,255,0.55);
  transition:0.25s;
}
button:hover{
  transform:scale(1.03);
  box-shadow:0 0 22px rgba(0,180,255,0.75);
}

/* LINKS */
a{
  color:#7ecbff;
  display:block;
  margin-top:12px;
  text-align:center;
  cursor:pointer;
  font-size:15px;
}
a:hover{
  text-shadow:0 0 8px #57b7ff;
}

/* ESCONDER */
.hidden{
  display:none;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="card">
  <h2>Entrar</h2>
  <input id="phoneLogin" type="tel" placeholder="Telefone">
  <input id="passLogin" type="password" placeholder="Senha">
  <button id="btnLogin">Entrar</button>
  <a id="linkShowRegister">Criar conta</a>
</div>

<!-- CADASTRO -->
<div id="registerBox" class="card hidden">
  <h2>Criar Conta</h2>
  <input id="userReg" type="text" placeholder="Nome de Usuário">
  <input id="phoneReg" type="tel" placeholder="Telefone">
  <input id="passReg" type="password" placeholder="Senha">
  <input id="inviteCodeReg" type="text" placeholder="Código de Convite (opcional)">
  <button id="btnRegister">Cadastrar</button>
  <a id="linkShowLogin">Já tenho conta</a>
</div>

<!-- SEU SCRIPT ORIGINAL (NÃO ALTERADO) -->
<script type="module">
  const firebaseConfig = {
    apiKey: "AIzaSyAcVPgUHbL4N9U1-H68klmGKWQF-YGleyc",
    authDomain: "vastbitloud-2872a.firebaseapp.com",
    projectId: "vastbitloud-2872a",
    storageBucket: "vastbitloud-2872a.firebasestorage.app",
    messagingSenderId: "952931184412",
    appId: "1:952931184412:web:ee2a0e38826c30dd0cd4d9",
    measurementId: "G-KWVQ0CFHW2"
  };

  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  function showMessage(msg, ok=false){
    const d=document.createElement('div');
    d.textContent=msg;
    Object.assign(d.style,{
      position:'fixed',top:'18px',left:'50%',transform:'translateX(-50%)',
      padding:'10px 14px',
      background: ok ? '#4CAF50' : '#ff4d4d',
      color:'#fff',
      borderRadius:'8px',zIndex:9999
    });
    document.body.appendChild(d);
    setTimeout(()=>d.remove(),2200);
  }

  const loginBox=document.getElementById('loginBox');
  const registerBox=document.getElementById('registerBox');

  document.getElementById('linkShowRegister').addEventListener('click', ()=>{
    loginBox.classList.add('hidden');
    registerBox.classList.remove('hidden');
  });

  document.getElementById('linkShowLogin').addEventListener('click', ()=>{
    registerBox.classList.add('hidden');
    loginBox.classList.remove('hidden');
  });

  const params = new URLSearchParams(window.location.search);
  const prefillCodigo = params.get('codigo');
  if(prefillCodigo){
    document.getElementById('inviteCodeReg').value = prefillCodigo;
  }

  document.getElementById('btnRegister').addEventListener('click', async ()=>{
    const user=document.getElementById('userReg').value.trim();
    const phone=document.getElementById('phoneReg').value.trim();
    const pass=document.getElementById('passReg').value.trim();
    const invitedBy=document.getElementById('inviteCodeReg').value.trim() || null;

    if(!user || !phone || !pass){
      showMessage('Preencha todos os campos!');
      return;
    }

    const myCode="VAST-" + Date.now().toString(36).toUpperCase();
    const localData={user, phone, pass, myCode, invitedBy};

    localStorage.setItem('vast_userdata', JSON.stringify(localData));
    localStorage.setItem('vast_logged','1');

    try{
      if(invitedBy){
        await addDoc(collection(db,"teams"),{
          owner: invitedBy,
          member: myCode,
          memberName:user,
          phone: phone,
          createdAt: Date.now()
        });
      }
    }catch(e){}

    showMessage('Conta criada com sucesso!', true);

    setTimeout(()=>{
      window.location.href='https://loptuy.github.io/Magaxiaa/';
    },700);
  });

  document.getElementById('btnLogin').addEventListener('click', ()=>{
    const phone=document.getElementById('phoneLogin').value.trim();
    const pass=document.getElementById('passLogin').value.trim();
    const stored=JSON.parse(localStorage.getItem('vast_userdata') || 'null');

    if(stored && phone===stored.phone && pass===stored.pass){
      localStorage.setItem('vast_logged','1');
      showMessage('Login realizado!', true);

      setTimeout(()=>{
        const next=params.get('next');
        if(next === 'equipe'){
          window.location.href='https://loptuy.github.io/Magaxiaa/equipe.html';
        } else {
          window.location.href='https://loptuy.github.io/Magaxiaa/';
        }
      },700);

    } else {
      showMessage('Telefone ou senha incorretos!');
    }
  });
</script>

</body>
</html>
